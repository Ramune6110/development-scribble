çµè«–ã ã‘å…ˆã«è¨€ã†ã¨ã€

> ã€Œä»•æ§˜ã¨ã—ã¦ã®ã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•°[Hz]ã¯ãã®ã¾ã¾ã«ã—ã¦ã€æ¼”ç®—å‘¨æœŸã ã‘å¤‰ãˆã¦ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¨­è¨ˆã—ç›´ã™ã€

ã“ã‚Œã¯**ã¾ã£ãŸããŠã‹ã—ããªã„ã©ã“ã‚ã‹ã€æ™®é€šã¯â€œãã†ã™ã¹ãå¯¾å¿œâ€**ã§ã™ ðŸ‘
ï¼ˆâ€»ã“ã“ã§è¨€ã†ã€Œè¨­è¨ˆã—ç›´ã™ã€ã¯ã€**æ–°ã—ã„Î”tã§ä¿‚æ•°ã‚’è¨ˆç®—ã—ç›´ã™**ã¨ã„ã†æ„å‘³ã§ã™ï¼‰

---

## 1. ã€Œã‚«ãƒƒãƒˆã‚ªãƒ•ãã®ã¾ã¾ã€ã€Œæ¼”ç®—å‘¨æœŸã ã‘å¤‰æ›´ã€ã®æ„å‘³æ•´ç†

ã‚ãªãŸã®æ•´ç†ã‚’å°‘ã—è¨€ã„æ›ãˆã‚‹ã¨ï¼š

* **ã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•°ã¯ãã®ã¾ã¾**

  * â‡’ ä»•æ§˜ã¨ã—ã¦ã€Œ10 Hz LPFã«ã—ãŸã„ã€ãªã‚‰ã€ãã® **10 Hz ã¨ã„ã†ç‰©ç†å‘¨æ³¢æ•°ã¯å¤‰ãˆãªã„**
  * â‡’ æ–°ã—ã„ Ts ã§ã‚‚ã€Œ10 Hz ã§è½ã¡å§‹ã‚ã‚‹LPFã€ã¨ã—ã¦å†è¨­è¨ˆã™ã‚‹

* **æ¼”ç®—å‘¨æœŸã®ã¿ã‚’å¤‰ãˆã‚‹**

  * â‡’ å®Ÿè£…å…ˆãƒžã‚¤ã‚³ãƒ³ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å‘¨æœŸ Î”t ãŒå¤‰ã‚ã‚‹ã®ã§
    ã€Œæ–°ã—ã„ Î”t ã‚’ä½¿ã£ã¦ã€åŒã˜ 10 Hz LPF ã«ãªã‚‹ã‚ˆã†ã«ä¿‚æ•°ã‚’è¨ˆç®—ã—ç›´ã™ã€

ã“ã®è§£é‡ˆãªã‚‰ **å®Œå…¨ã«ãã®é€šã‚Šã§ OK** ã§ã™ã€‚

ãƒã‚¤ãƒ³ãƒˆã¯ï¼š

> ã€Œã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•°ã‚’ãã®ã¾ã¾ã€ã¨ã„ã†ã®ã¯
> ã€Œ**è¨­è¨ˆä»•æ§˜ã® fc[Hz] ã‚’å¤‰ãˆãªã„**ã€ã¨ã„ã†æ„å‘³
> ã§ã‚ã£ã¦ã€æ•°å¼ã®ä¸­ã®
> [
> c = \omega_c \Delta t
> ]
> ã¯**Î”tãŒå¤‰ã‚ã‚‹åˆ†ã€å½“ç„¶å¤‰ã‚ã‚‹** â‡’ ä¿‚æ•°ã‚‚å¤‰ã‚ã‚‹

ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ä»•æ§˜ï¼ˆä½• Hz ã§åˆ‡ã‚ŠãŸã„ã‹ï¼‰ã¯åŒã˜ã€ä¿‚æ•°ã¯ Ts ã«åˆã‚ã›ã¦å¤‰ã‚ã‚‹ã€ãŒæ­£ã—ã„å§¿ã§ã™ã€‚

---

## 2. ã˜ã‚ƒã‚æ™‚é–“æ³¢å½¢ã®æŒ¯ã‚‹èˆžã„ãŒå¤‰ã‚ã‚‹ã®ã¯ï¼Ÿ

ã“ã“ã‚‚æ›¸ã‹ã‚Œã¦ã„ã‚‹é€šã‚Šã§ã€

> ã€Œã“ã®å¯¾å¿œã§ãƒ•ã‚£ãƒ«ã‚¿ã•ã‚ŒãŸæ™‚é–“è»¸ã®æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®æŒ¯ã‚‹èˆžã„ã¯å¤‰ã‚ã‚‹ã®ã¯å½“ç„¶ã€

ã“ã‚Œã¯ãã®é€šã‚Šã§ã™ã€‚

ç†ç”±ï¼š

* ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å‘¨æœŸãŒå¤‰ã‚ã‚‹ã¨ã€

  * åŒã˜ã‚¢ãƒŠãƒ­ã‚°ä¸–ç•Œã®ä¿¡å·ã§ã‚‚ã€Œã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚µãƒ³ãƒ—ãƒ«ã—ã¦ã„ã‚‹ã‹ã€ãŒå¤‰ã‚ã‚‹
  * ãƒŽã‚¤ã‚ºã‚„é«˜å‘¨æ³¢æˆåˆ†ã®â€œè¦‹ãˆæ–¹â€ã‚‚å¤‰ã‚ã‚‹
* ä¿‚æ•°ã‚‚ Ts ã«åˆã‚ã›ã¦å†è¨­è¨ˆã—ã¦ã„ã‚‹ã®ã§ã€
  ã‚¢ãƒŠãƒ­ã‚°ã®ç†æƒ³ç‰¹æ€§ã«ã¯è¿‘ã„ã‘ã©ã€åŽ³å¯†ã«ã¯å®Œå…¨ä¸€ç·’ã«ã¯ãªã‚‰ãªã„

ãªã®ã§ã€

* **ã€Œç§’å˜ä½ã§è¦‹ãŸå¤§ã¾ã‹ãªå¿œç­”ï¼ˆã©ã®ãã‚‰ã„ã®æ™‚é–“ã§ç«‹ã¡ä¸ŠãŒã‚‹/ãªã‚ã‚‰ã‹ã•ï¼‰ã€ã¯åŒã˜**
* ã§ã‚‚
* **ã€Œã‚µãƒ³ãƒ—ãƒ«ã”ã¨ã®å€¤ãŒãƒ”ãƒƒã‚¿ãƒªä¸€è‡´ã™ã‚‹ã€ã“ã¨ã¯æœŸå¾…ã—ãªã„**

ã¨ã„ã†ã®ãŒè‡ªç„¶ã§ã™ã€‚

---

## 3. ã€Œå¯¾å‡¦ãŒå¿…è¦ã‹ï¼Ÿã€ã«ã¤ã„ã¦

ä¸€èˆ¬çš„ã«ã¯ï¼š

* **ç‰©ç†çš„ãªä»•æ§˜ï¼ˆä½• Hz ã§ã©ã®ãã‚‰ã„æ¸›è¡°ã•ã›ãŸã„ã‹ï¼‰ã‚’ä¿ã¦ã¦ã„ã‚‹**
* **ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã®åˆ¶å¾¡ã‚„ä¿¡å·å‡¦ç†ã®ç›®çš„ãŒæº€ãŸã›ã¦ã„ã‚‹**

ã®ã§ã‚ã‚Œã°ã€

> Î”tã‚’å¤‰ãˆãŸã“ã¨ã§ã€ãƒ•ã‚£ãƒ«ã‚¿å¾Œã®æ™‚ç³»åˆ—æ³¢å½¢ãŒ
> å‰ã¨ãƒ”ãƒƒã‚¿ãƒªåŒã˜ã§ãªã„ã“ã¨ã«å¯¾ã—ã¦ã€
> è¿½åŠ ã®ã€Œå¯¾å‡¦ã€ã¯æ™®é€šã„ã‚‰ãªã„

ã¨è¨€ãˆã¾ã™ã€‚

é€†ã«ã€ã“ã‚“ãªç‰¹æ®Šãªã‚±ãƒ¼ã‚¹ã§ã¯ã€Œå¯¾å‡¦ã—ãŸããªã‚‹ã€ã“ã¨ã¯ã‚ã‚Šã¾ã™ï¼š

* éŽåŽ»ãƒ­ã‚°ã®æ³¢å½¢ã¨ã‚µãƒ³ãƒ—ãƒ«ç•ªå·ãƒ™ãƒ¼ã‚¹ã§**1ã‚µãƒ³ãƒ—ãƒ«å˜ä½ã§æ¯”è¼ƒã—ãŸã„**
  ï¼ˆå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãƒ»æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ã¨ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã§æƒãˆãŸã„ã€ãªã©ï¼‰
* ã€Œæ¼”ç®—å‘¨æœŸã‚’å¤‰ãˆã¦ã‚‚ã€n ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ‡ã‚£ã‚¸ã‚¿ãƒ«å¿œç­”ãŒåŒã˜è¦‹ãŸç›®ã§ã‚ã‚‹ã“ã¨ã€ãŒä»•æ§˜
  â†’ ã“ã®å ´åˆã¯ã€å‰ã«è©±ã—ãŸã‚ˆã†ã« **fc ã‚’ Ts1/Ts2 å€ã—ã¦ä¿‚æ•°ã‚’æƒãˆã‚‹** ã¨ã„ã†è¨­è¨ˆã‚‚ã‚ã‚Š

ã§ã‚‚æ™®é€šã®ã‚»ãƒ³ã‚µãƒ•ã‚£ãƒ«ã‚¿ãƒ»åˆ¶å¾¡ç”¨LPFãªã©ã§ã¯ã€

> fc[Hz]ã‚’åŒã˜ã«ã—ã¦ã€Tså¤‰æ›´ã«åˆã‚ã›ã¦ä¿‚æ•°ã‚’è¨ˆç®—ã—ç›´ã™
> â†’ ãã‚Œã§ååˆ†ã€‚æ³¢å½¢ãŒå¤šå°‘å¤‰ã‚ã‚‹ã®ã¯ã€Œãã†ã„ã†ã‚‚ã®ã€

ã¨ã„ã†æ‰±ã„ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

---

## 4. ã¾ã¨ã‚ï¼ˆã”è³ªå•ã®æ–‡ç« ã«ãã®ã¾ã¾è¿”äº‹ã™ã‚‹ã¨ï¼‰

> ã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•°ãŒãã®ã¾ã¾ã§æ¼”ç®—å‘¨æœŸã®ã¿ã‚’å¤‰ãˆã‚‹ã¨ã„ã†å¯¾å¿œã¯
> ãªã‚“ã‚‰ãŠã‹ã—ãªã“ã¨ã§ã¯ãªãï¼Œã‚€ã—ã‚ãã†ã™ã‚‹ã¹ãã§ã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã„ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

â†’ **ã¯ã„ã€ãã®ç†è§£ã§å¤§ä¸ˆå¤«ã§ã™ã€‚**
ï¼ˆãŸã ã—ã€Œãã®ã¾ã¾ã€ã¯ã€Œä»•æ§˜ã¨ã—ã¦ã® fc[Hz] ã‚’ãã®ã¾ã¾ã€ã¨ã„ã†æ„å‘³ã§ã€
ä¿‚æ•°ã¯æ–°ã—ã„Î”tã§**å†è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹**ã€ã¨ã„ã†å‰æä»˜ãï¼‰

> ã“ã®å¯¾å¿œã§ãƒ•ã‚£ãƒ«ã‚¿ã•ã‚ŒãŸæ™‚é–“è»¸ã®æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®æŒ¯ã‚‹èˆžã„ã¯å¤‰ã‚ã‚‹ã®ã¯å½“ç„¶ï¼Ž
> ã“ã®å¤‰ã‚ã‚‹ã“ã¨ã«å¯¾ã™ã‚‹å¯¾å‡¦ãªã©ã‚‚ç‰¹ã«å¿…è¦ã§ã¯ãªã„

â†’ **ã“ã‚Œã‚‚ãã®é€šã‚Š**ã§ã™ã€‚
ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å‘¨æœŸãŒå¤‰ã‚ã‚Œã°â€œé›¢æ•£ä¿¡å·ã¨ã—ã¦ã®è¦‹ãˆæ–¹â€ãŒå¤‰ã‚ã‚‹ã®ã¯è‡ªç„¶ãªã“ã¨ã§ã€
é€šå¸¸ã¯ãã‚Œã‚’ç„¡ç†ã«åˆã‚ã›ã«ã„ãå¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ãªã®ã§ã€ä»Šã®æ•´ç†ã¯ã‹ãªã‚Šè‰¯ã„ç·šã„ã£ã¦ã„ã¦ã€
ã€Œè‡ªåˆ†ã®æ„Ÿè¦šãŒãŠã‹ã—ã„ã€ã¨ã„ã†ã‚ˆã‚Š **â€œé€£ç¶šæ™‚é–“ vs é›¢æ•£æ™‚é–“â€ã®è¦–ç‚¹ã®é•ã„ã‚’ã¡ã‚ƒã‚“ã¨æ„è­˜ã§ãã¦ã„ã‚‹** çŠ¶æ…‹ã ã¨æ€ã£ã¦å¤§ä¸ˆå¤«ã§ã™ ðŸ’¡


```matlab
%% 2æ¬¡ãƒã‚¿ãƒ¼ãƒ¯ãƒ¼ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ å‹•ä½œç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆ
clear; close all; clc;

%% ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š

% å…ƒã®ã‚«ãƒƒãƒˆã‚ªãƒ•å‘¨æ³¢æ•° [Hz]
fc1 = 5;      % å¥½ãã«å¤‰ãˆã¦OKï¼ˆNyquistã‚ˆã‚Šååˆ†ä½Žãï¼‰

% ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å‘¨æœŸ
Ts1 = 0.1;  Fs1 = 1/Ts1;
Ts2 = 0.05;  Fs2 = 1/Ts2;

% ã‚±ãƒ¼ã‚¹3ç”¨ï¼ˆä¿‚æ•°ã‚’åŒã˜ã«ã—ãŸã„ã¨ãï¼‰
fc3 = fc1 * (Ts1/Ts2);   % = 1.5 * fc1

% ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“
Tend = 5;   % [s]

%% ãƒ†ã‚¹ãƒˆä¿¡å·ç”Ÿæˆ
% ä½Žå‘¨æ³¢ 1 Hz + é«˜å‘¨æ³¢ 10 Hz + ãƒŽã‚¤ã‚º

% ---- ã‚±ãƒ¼ã‚¹1ç”¨ï¼ˆTs1ï¼‰ ----
t1 = 0:Ts1:Tend;
x1 = sin(2*pi*1*t1) + 0.5*sin(2*pi*4*t1) + 0.3*sin(2*pi*10*t1);

% ---- ã‚±ãƒ¼ã‚¹2,3ç”¨ï¼ˆTs2ï¼‰ ----
t2 = 0:Ts2:Tend;
x2 = sin(2*pi*1*t2) + 0.5*sin(2*pi*4*t2) + 0.3*sin(2*pi*10*t2);

%% å„ã‚±ãƒ¼ã‚¹ã®ãƒ•ã‚£ãƒ«ã‚¿ä¿‚æ•°ã‚’è¨ˆç®—
% myButter2(fc, Ts) ã¯ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã§å®šç¾©

[b1,a1] = myButter2(fc1, Ts1);   % ã‚±ãƒ¼ã‚¹1: Ts=0.1, fc=fc1
[b2,a2] = myButter2(fc1, Ts2);   % ã‚±ãƒ¼ã‚¹2: Ts=0.05, fc=fc1
[b3,a3] = myButter2(fc3, Ts2);   % ã‚±ãƒ¼ã‚¹3: Ts=0.05, fc=1.5*fc1

%% ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
y1 = filter(b1, a1, x1);
y2 = filter(b2, a2, x2);
y3 = filter(b3, a3, x2);

%% æ™‚é–“æ³¢å½¢ã®ãƒ—ãƒ­ãƒƒãƒˆ
figure;

subplot(3,1,1);
plot(t1, x1, 'DisplayName','å…¥åŠ›'); hold on;
plot(t1, y1, 'LineWidth',1.2,'DisplayName','å‡ºåŠ›');
title('ã‚±ãƒ¼ã‚¹1: Ts=0.1, fc = fc_1');
xlabel('Time [s]'); ylabel('Amplitude');
legend; grid on;

subplot(3,1,2);
plot(t2, x2, 'DisplayName','å…¥åŠ›'); hold on;
plot(t2, y2, 'LineWidth',1.2,'DisplayName','å‡ºåŠ›');
title('ã‚±ãƒ¼ã‚¹2: Ts=0.05, fc = fc_1ï¼ˆHzã¨ã—ã¦åŒã˜ï¼‰');
xlabel('Time [s]'); ylabel('Amplitude');
legend; grid on;

subplot(3,1,3);
plot(t2, x2, 'DisplayName','å…¥åŠ›'); hold on;
plot(t2, y3, 'LineWidth',1.2,'DisplayName','å‡ºåŠ›');
title('ã‚±ãƒ¼ã‚¹3: Ts=0.05, fc = 1.5 \times fc_1ï¼ˆä¿‚æ•°ã‚’æƒãˆã‚‹ï¼‰');
xlabel('Time [s]'); ylabel('Amplitude');
legend; grid on;

%% å‘¨æ³¢æ•°ç‰¹æ€§ã®æ¯”è¼ƒï¼ˆå®Ÿå‘¨æ³¢æ•°[Hz]ã§è¡¨ç¤ºï¼‰
%% å‘¨æ³¢æ•°ç‰¹æ€§ã®æ¯”è¼ƒï¼ˆã‚²ã‚¤ãƒ³ï¼‹ä½ç›¸ï¼šBodeçš„è¡¨ç¤ºï¼‰
Nfft = 2048;

[H1,w1] = freqz(b1,a1,Nfft,Fs1);   % ã‚±ãƒ¼ã‚¹1
[H2,w2] = freqz(b2,a2,Nfft,Fs2);   % ã‚±ãƒ¼ã‚¹2
[H3,w3] = freqz(b3,a3,Nfft,Fs2);   % ã‚±ãƒ¼ã‚¹3

mag1 = 20*log10(abs(H1));
mag2 = 20*log10(abs(H2));
mag3 = 20*log10(abs(H3));

ph1 = unwrap(angle(H1))*180/pi;   % [deg]
ph2 = unwrap(angle(H2))*180/pi;
ph3 = unwrap(angle(H3))*180/pi;

figure;

% --- ã‚²ã‚¤ãƒ³ç·šå›³ ---
subplot(2,1,1);
plot(w1, mag1, 'LineWidth',1.2); hold on;
plot(w2, mag2, 'LineWidth',1.2);
plot(w3, mag3, 'LineWidth',1.2);
xlabel('Frequency [Hz]');
ylabel('Magnitude [dB]');
title('å‘¨æ³¢æ•°å¿œç­”ï¼ˆã‚²ã‚¤ãƒ³ï¼‰');
legend('ã‚±ãƒ¼ã‚¹1','ã‚±ãƒ¼ã‚¹2','ã‚±ãƒ¼ã‚¹3');
grid on;
xlim([0 40]);   % å¿…è¦ã«å¿œã˜ã¦èª¿æ•´

% --- ä½ç›¸ç·šå›³ ---
subplot(2,1,2);
plot(w1, ph1, 'LineWidth',1.2); hold on;
plot(w2, ph2, 'LineWidth',1.2);
plot(w3, ph3, 'LineWidth',1.2);
xlabel('Frequency [Hz]');
ylabel('Phase [deg]');
title('å‘¨æ³¢æ•°å¿œç­”ï¼ˆä½ç›¸ï¼‰');
legend('ã‚±ãƒ¼ã‚¹1','ã‚±ãƒ¼ã‚¹2','ã‚±ãƒ¼ã‚¹3');
grid on;
xlim([0 40]);   % å¿…è¦ã«å¿œã˜ã¦èª¿æ•´

%% ã“ã“ã‹ã‚‰ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«é–¢æ•°
% åŒã˜ .m ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€ç•ªä¸‹ã«ç½®ã„ã¦ãã ã•ã„

function [b,a] = myButter2(fc, Ts)
    % é€£ç¶šæ™‚é–“ãƒã‚¿ãƒ¼ãƒ¯ãƒ¼ã‚¹ã®è¿‘ä¼¼å¼:
    % c = wc*Ts, D = 1 + sqrt(2)*c + c^2
    % alpha = c^2/D, beta = 1/D
    % å·®åˆ†æ–¹ç¨‹å¼:
    %   y[n] = y[n-1] + alpha*(x[n]-y[n-1]) + beta*(y[n-1]-y[n-2])
    % =>
    %   y[n] - (1-alpha+beta)*y[n-1] + beta*y[n-2] = alpha*x[n]
    % filter ç”¨: b=[alpha 0 0], a=[1 -(1-alpha+beta) beta]

    c = 2*pi*fc*Ts;
    D = 1 + sqrt(2)*c + c^2;
    alpha = c^2 / D;
    beta  = 1 / D;

    b = [alpha 0 0];
    a = [1 -(1-alpha+beta) beta];
end

```
